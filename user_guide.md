# 文稿比對系統使用說明

## 系統簡介

文稿比對系統是一個專為出版社和編輯人員設計的工具，用於比對原始Word文件與美編後PDF文件的內容差異，幫助校對人員快速找出不一致之處。系統整合了多種先進技術，包括上下文感知匹配、高級OCR處理和生成式AI輔助比對，提供高精度的比對結果和直觀的差異展示。

## 主要功能

1. **文本提取**：從Word和PDF文件中提取文本內容
2. **多種比對模式**：提供精確比對、語意比對、混合比對、上下文感知比對和生成式AI比對
3. **高級OCR處理**：支援多種OCR引擎，包括Tesseract、EasyOCR和Qwen API
4. **生成式AI輔助**：支援多種AI模型，提供更準確的段落匹配和智能分析
5. **視覺化差異展示**：直觀顯示文本差異，支援字符級別、詞語級別和行級別的差異展示
6. **PDF頁面預覽**：顯示PDF頁面並標記差異位置
7. **表格比對**：支援表格內容的比對和差異展示
8. **自定義AI整合**：支援使用自定義AI API進行比對和分析，包括免費API選項

## 系統需求

- Python 3.7+
- Streamlit
- PyMuPDF (fitz)
- python-docx
- pandas
- numpy
- PIL
- 其他依賴庫（詳見requirements.txt）

## 安裝指南

1. 安裝Python 3.7+
2. 安裝依賴庫：
   ```
   pip install -r requirements.txt
   ```
3. 安裝OCR相關庫（可選）：
   ```
   pip install easyocr pytesseract
   ```
4. 安裝Java（用於表格提取，可選）：
   ```
   sudo apt-get install -y default-jre
   ```
5. 安裝語義模型（可選）：
   ```
   pip install sentence-transformers
   ```

## 使用方法

1. 啟動應用程式：
   ```
   streamlit run app.py
   ```
2. 在瀏覽器中打開顯示的URL（通常是http://localhost:8501）
3. 上傳原始Word文件和美編後PDF文件
4. 設置比對參數（比對模式、相似度閾值、忽略選項等）
5. 點擊「開始比對」按鈕
6. 查看比對結果和差異展示

## 比對模式說明

1. **精確比對**：基於字符級別的精確比對，適合要求嚴格的場景
2. **語意比對**：基於語義的比對，能夠理解文本含義，適合內容表達方式有變化的場景
3. **混合比對**：結合精確比對和語意比對，平衡精確度和語義理解
4. **上下文感知比對**：考慮段落的上下文關係，提供更準確的匹配結果
5. **生成式AI比對**：使用AI模型進行段落匹配，提供最高精度的比對結果

## OCR引擎說明

1. **自動選擇**：系統自動選擇最適合的OCR引擎
2. **Tesseract**：開源OCR引擎，支援多種語言
3. **OpenOCR (EasyOCR)**：高精度OCR引擎，支援多種語言和複雜排版
4. **Qwen API**：阿里巴巴的Qwen模型API，提供最高精度的OCR和表格識別

## 生成式AI模型說明

1. **本地模型**：
   - BERT多語言模型：支援多語言的通用模型
   - MPNet中文模型：專為中文優化的模型
   - RoBERTa中文模型：另一種專為中文優化的模型

2. **API模型**：
   - OpenAI API：使用GPT-4模型，提供高精度段落匹配
   - Anthropic API：使用Claude模型，提供高精度段落匹配
   - Gemini API：使用Google的Gemini Pro模型，提供高精度段落匹配
   - Qwen API：使用阿里巴巴的Qwen Max模型，提供高精度段落匹配
   - 自定義AI：支援多種API格式（OpenAI、Anthropic、Qwen），也可以使用免費API

## 自定義AI功能說明

系統整合了自定義AI功能，允許用戶使用自己選擇的AI API進行比對和分析：

1. **免費API選項**：即使沒有API Key，也可以使用系統提供的免費API
2. **多種API格式支援**：自動識別並支援OpenAI、Anthropic和Qwen等多種API格式
3. **語義比對**：使用AI進行高精度的語義比對
4. **比對結果分析**：提供專業的比對結果分析和建議

使用方法：
1. 在比對模式中選擇「生成式AI比對」
2. 在AI模型中選擇「自定義AI」
3. 可選填入API Key和API URL（如不填則使用免費API）
4. 開始比對

## 常見問題

1. **問題**：比對結果不準確
   **解決方案**：嘗試調整相似度閾值或更換比對模式

2. **問題**：PDF文本提取不完整
   **解決方案**：啟用OCR功能或嘗試更換OCR引擎

3. **問題**：表格比對結果不理想
   **解決方案**：確保Java已正確安裝，或使用Qwen API進行表格提取

4. **問題**：生成式AI功能無法使用
   **解決方案**：檢查API Key是否正確設置，或嘗試使用自定義AI的免費API選項

5. **問題**：自定義AI返回錯誤
   **解決方案**：確認API URL格式正確，或留空使用免費API

## 聯絡支援

如有任何問題或建議，請聯絡系統管理員或開發團隊。
