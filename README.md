.
├── app.py                   # Streamlit 入口點 / 前端 UI 與整體流程控制
├── requirements.txt         # Python 依賴清單
├── custom.css               # 自訂頁面樣式（顏色、佈局、動畫）
├── comparison_algorithm.py  # 段落比對核心（精確/語意/混合比對、AI 輔助比對）
├── text_extraction.py       # 基礎文字抽取（Word/PDF 文本、段落、頁碼）
├── enhanced_extraction.py   # 進階文字抽取（表格、圖片標註、OCR 辨識）
├── generative_ai.py         # AI 核心（語意分析、相似度計算、差異摘要）
├── custom_ai.py             # AI 端點整合（支援多種 API 介接與替換）
├── qwen_ocr.py              # OCR 主模組（圖文辨識、表格偵測與擷取）
├── qwen_api.py              # Qwen OCR API 介接（相容舊版用途）
└── README.md                # 專案說明文件

## 📘 系統比對邏輯說明

在企業永續或財務報告書製作流程中，常需將**美編前原稿（Word 檔）**與**美編後完稿（PDF 檔）**進行內容比對，以確認編排過程中是否出現錯字、漏字、誤植數據、錯位、格式異動等問題。這類比對作業若純依人工進行，將極為耗時，且容易漏看。因此，本系統設計的目的是**透過文字抽取與智能比對演算法，自動找出原始內容與排版結果的異同**，以加速校對流程。

### 比對邏輯說明：

#### ✅ 以 PDF 美編後完稿為比對主體（主軸）
系統會逐頁處理 PDF 文件，每頁的內容視為獨立的比對目標。

#### ✅ 以 Word 原稿為比對來源池
原稿可能來自單一或多份 Word 文件，系統會將所有段落內容進行預處理後，作為潛在的對應來源。

#### ✅ 支援多段對一頁（N:1）比對邏輯
PDF 每一頁的內容可能來自 Word 的多個段落甚至多個位置，因此系統支援將 Word 段落內容組合後與 PDF 頁進行最佳相似比對（非單一段落比對）。

#### ✅ 逐句分析與語意比對
PDF 頁內的每一段文字將進行下列多層次比對：
- 精確比對（Exact Matching）
- 語意比對（Semantic Matching / AI 比對）
- 子字串比對（Substring Similarity，用於處理短句拆分情況）

#### ✅ 頁面呈現與結果說明
使用者可在畫面中查看：
- 每一頁 PDF 對應的 Word 段落來源與比對相似度
- 每一段 PDF 文字的比對結果（包括相符段、差異 highlight、無匹配段）
- 相似度分數與差異重點提示

#### ✅ 表格支援與差異分析
系統支援表格內容的單元格級比對，可標示欄位變動、數值誤植、格式異動等問題。





## 文件說明

- **app.py**: 主應用程序文件，集成了所有功能
- **qwen_ocr.py**: 實現了無API key的OCR功能
- **generative_ai.py**: 實現了無API key的生成式AI功能
- **comparison_algorithm.py**: 實現了表格比對算法
- **text_extraction.py**: 文本提取和處理功能

## 使用說明

1. **安裝依賴**
   ```
   pip install streamlit pandas numpy requests sentence-transformers easyocr tabula-py pymupdf pillow
   ```

2. **運行應用**
   ```
   streamlit run app.py
   ```

3. **使用免費API**
   - 默認使用免費API，無需輸入API key
   - 在側邊欄選擇"Qwen (免費)"選項

4. **使用付費API**
   - 在側邊欄選擇"Qwen (API)"選項
   - 輸入您的API key

5. **表格比對功能**
   - 上傳包含表格的文件後，系統會自動進行表格比對
   - 在"表格比對結果"標籤頁查看比對結果
   - 表格差異會以顏色標記顯示

## 注意事項

1. 免費API可能有使用限制，如果遇到問題，可以切換到付費API
2. 表格比對功能對於複雜表格可能需要更長的處理時間
3. 對於大型文件，建議增加處理超時時間

## 技術細節

1. **表格比對算法**
   - 使用單元格對單元格的比對方式
   - 計算表格整體相似度
   - 生成差異矩陣，用於可視化顯示

2. **免費API實現**
   - 使用公開可用的API端點
   - 自動處理API請求格式
   - 解析API響應，提取所需信息

3. **差異可視化**
   - 使用顏色區分添加、刪除和修改的內容
   - 提供字符級別、詞語級別和行級別的差異顯示
   - 表格差異使用顏色標記，直觀顯示不同的單元格
